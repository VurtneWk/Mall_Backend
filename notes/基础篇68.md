## 68、商品服务-API-品牌管理-JSR303分组校验

场景：`brandId` 字段，在新增时不能传递，但是更改、删除等时，必须传递。

### 实现步骤

> 创建两个接口

```kotlin
interface AddGroup {
}
interface UpdateGroup {
}
```

> 然后在属性上指明什么情况下校验

```kotlin
    @TableId
    @field:Null(message = "新增不能指定ID", groups = [AddGroup::class])
    @field:NotNull(message = "修改必须指定品牌ID", groups = [UpdateGroup::class])
    var brandId: Long? = null,
```

> 最后需要修改controller,用于标注验证哪个分组

```kotlin
    @RequestMapping("/save")
    fun save(@RequestBody @Validated(AddGroup::class)  brand: BrandEntity): R {
        brandService.save(brand)
        return R.ok()
    }

    @RequestMapping("/update")
    fun update(@RequestBody @Validated(UpdateGroup::class) brand: BrandEntity): R {
        brandService.updateById(brand)
        return R.ok()
    }
```

> [!caution]
>
> 当 @Validated(UpdateGroup::class) 添加分组后，未进行分组的属性，将失效，不再验证

```kotlin
    @field:URL(message = "logo必须是一个合法的url地址" ,  groups = [AddGroup::class, UpdateGroup::class])
    @field:NotBlank( groups = [AddGroup::class])
    var logo: String = "",
```

这个说明：新增时不能为空，也必须合法； 修改时可以不携带，但是如果有就必须合法